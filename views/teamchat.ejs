<!DOCTYPE html>
<html>

<head>
    <title>MS Team Clone</title>
    <link rel="stylesheet" href="/css/chat3.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" />
    <script>
        const roomId = "<%= id %>"
        console.log("ID : <%= id %>");
        console.log("ID : <%= team.ChatID %>");
        const username = "<%= user.username %>"
    </script>
    <style>
        @import url("https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap");
        .left{
            width: 50px;
            height: 100%;
            background: #2f2f2f;
            white-space: nowrap;
            transition: width 0.5s ;
            position: fixed;
            z-index: 9999;
        }
        .left ul{
            padding: 0;
            list-style-type: none;
            text-align: left;
        }
        .left li {
            width: auto;
            height: 60px;
            line-height: 50px;
            padding-left: 18px;
        }
        .left li:hover {
            background: black;
        }

        .left:hover {
            width: 250px;
        }

        .left .item-menu {
            height:50px;
            overflow:hidden;
            color:#fff;
        }
        .left a{
            color: white;
            text-decoration: none;
            font-weight: bold;
        }
        span.menu{
            padding-left: 17px;
        }
        .t_search {
            color: black;
            height: 35px;
            margin-left: 15px;
            width: 190px
        }
        body {
            background-color: #2b1a4b;
        }
        body::-webkit-scrollbar {
            display: none;
        }

        :root {
            --header-height: 3rem;
            --nav-width: 68px;
            --first-color: #18161d;
            --first-color-light: #AFA5D9;
            --white-color: #F7F6FB;
            --body-font: 'Nunito', sans-serif;
            --normal-font-size: 1rem;
            --z-fixed: 100
        }

        *,
        ::before,
        ::after {
            box-sizing: border-box
        }

        a {
            text-decoration: none
        }

        .header {
            width: 100%;
            height: var(--header-height);
            position: fixed;
            top: 0;
            left: 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 1rem;
            background-color: black;
            z-index: var(--z-fixed);
            transition: .5s

        }

        .l-navbar {
            position: fixed;
            top: 0;
            left: -30%;
            width: var(--nav-width);
            height: 100%;
            background-color: var(--first-color);
            padding: .5rem 1rem 0 0;
            transition: .5s;
            z-index: var(--z-fixed)
        }
        .fa{
            font-size: 20px;
        }
        .nav {
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            overflow: hidden
        }

        .nav_logo,
        .nav_link {
            display: grid;
            grid-template-columns: max-content max-content;
            align-items: center;
            column-gap: 1rem;
            padding: .5rem 0 .5rem 1.5rem
        }

        .nav_logo {
            margin-bottom: 2rem
        }

        .nav_logo-icon {
            font-size: 1.25rem;
            color: var(--white-color)
        }

        .nav_link {
            position: relative;
            color: var(--first-color-light);
            margin-bottom: 1.5rem;
            transition: .3s
        }

        .nav_link:hover {
            color: var(--white-color)
        }

        .nav_icon {
            font-size: 1.25rem
        }

        .active {
            color: var(--white-color)
        }

        .active::before {
            content: '';
            position: absolute;
            left: 0;
            width: 2px;
            height: 32px;
            background-color: var(--white-color)
        }

        @media screen and (min-width: 768px) {
            body {
                margin: calc(var(--header-height) + 1rem) 0 0 0;
                padding-left: calc(var(--nav-width) + 2rem)
            }

            .header {
                height: calc(var(--header-height) + 1rem);
                padding: 0 2rem 0 calc(var(--nav-width) + 2rem)
            }

            .l-navbar {
                left: 0;
                padding: 1rem 1rem 0 0
            }

        }
        .col-2{
            background-color: #2b1a4b;
            height: 100%;
        }
        .col-10{
            background-color: #635890;
            height: 100%;
        }
        .chat__sidebar{
            background-color: #2b1a4b;
            overflow-y: hidden;
            margin-left: -30px;
            height: calc(100vh - 68px);
            padding: 40px 10px 10px 10px;
            width:300px;
        }
        .chat__main{
            background-color: white;
            overflow-y: hidden;
            height: calc(100vh - 68px);
            box-shadow: 0 -15px 0 0 black;
        }
        .chat__messages{
            /*margin-top: 67px;*/
            /*overflow-y: hidden;*/
            height: 100%;
        }
        .message{
            background-color: #d2caf3;
            border-radius: 30px;
            padding: 10px 10px  10px 30px;
            width: 40%;
        }
        span{
            text-wrap: normal;
        }
        a{
            text-decoration: none;
            color: white;
            font-size: 20px;
        }
        a:hover {
            color: #d2caf3;
            text-decoration: none;
        }
        .container{
            margin-top:30px;
            padding:10px;
        }
        #send-btn{
            background-color: #7C5CBF;
            color: white;
            width: 100px
        }
        ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
    width: 200px;
    background-color: #f1f1f1;
  }
  
  li a {
    display: block;
    color: #000;
    padding: 8px 16px;
    text-decoration: none;
  }
  
  li a.active {
    background-color: #8610b1;
    color: white;
  }
  
  li a:hover:not(.active) {
    background-color: rgb(182, 136, 202);
    color: white;
  }
    </style>
</head>
<body>
<header class="header" id="header">
    <div class="container-fluid">
        <a class="navbar-brand" href="#" style="color: white">Microsoft Teams</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNavDropdown">
            <ul class="navbar-nav" style="color: white">
                <li class="nav-item">
                    <a class="nav-link active" aria-current="page" href="#" style="color: white">Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" style="color: white">Features</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" style="color: white">Pricing</a>
                </li>
            </ul>
        </div>
        <div class="nav-item dropdown" style="float: right;margin-right:20px">
            <a class="nav-link dropdown-toggle" id="navbarDropdownMenuLink2" data-toggle="dropdown" style="color: white"><i class="fa fa-user-circle-o" aria-hidden="true"></i></a>
            <div class="dropdown-menu dropdown-primary" aria-labelledby="navbarDropdownMenuLink">
                <a class="dropdown-item" href="#"><%= user.username %></a>
                <a class="dropdown-item" href="/settings/profile">Profile</a>
                <a class="dropdown-item" href="/logout">Logout</a>
            </div>
        </div>
    </div>
</header>
<div class="l-navbar" id="nav-bar">
    <nav class="nav">
        <div>
            <a href="#" class="nav_logo"> <i class='bx bx-layer nav_logo-icon'></i></span> </a>
            <div class="nav_list">
                <a href="/" class="nav_link active">
                    <i class="fa fa-home" aria-hidden="true"></i>
                    <span class="nav_name"></span>
                </a>
                <a href="#" class="nav_link">
                    <i class="fa fa-users" aria-hidden="true"></i>
                </a>
                <a href="#" class="nav_link">
                    <i class="fa fa-bell" aria-hidden="true"></i>
                </a>
                <a href="/chat" class="nav_link">
                    <i class="fa fa-comments-o" aria-hidden="true"></i>
                </a>
                <a href="#" class="nav_link">
                    <i class="fa fa-phone" aria-hidden="true"></i>
                </a>
                <a href="#" class="nav_link">
                    <i class="fa fa-files-o" aria-hidden="true"></i>
                </a>
            </div>
        </div>
    </nav>
</div>
    <div class="chat">
        <div class="chat__sidebar">
            <img src="<%= team.avatar %>" width="200" height="200"><br><br>
                <h2><b><%= team.team_name %></b></h2>
                <ul>
                    <li><a href="/team/<%= team.team_name %>">Calls</a></li>
                    <li><a href="#" class="active">Chat</a></li>
                    <li><a href="/team/info/<%= team.team_name %>">Team Info</a></li>
                    <li><a href="/settings/manage_team/<%= team.team_name %>">Manage</a></li>
                    <li><a href="/team/leave_team/<%= team.team_name %>">Leave team</a></li>
                </ul>

        </div>
        <div class="chat__main">
            <div id="messages" class="chat__messages">
               <% if(prevChat != null && prevChat.msg != null) { %>
               <% (prevChat.msg).forEach((msg)=>{ %>
                        <div class="container-fluid">
                            <div class="message">
                            <p>
                                <span class="message__name"><%= msg.username %></span>
                                <span class="message__meta"><%= msg.timestamp %></span>
                            
                            </p>
                            
                            <p><%= msg.message %></p>
                            
                        </div>
                            
                    </div>
               <% }) } %>

            </div>

            <div class="compose">
                <form id="message-form">
                    <input name="message" placeholder="Message">
                    <button id="send-btn" class="btn"><i class="fa fa-paper-plane" aria-hidden="true"></i> Send</button>
                </form>
            </div>
        </div>
    </div>

    <script id="message-template" type="text/html">
            <div class="message">
                <p>
                   <span class="message__name">{{username}}</span>
                   <span class="message__meta">{{createdAt}}</span>
                </p>
                <p>{{message}}</p>
            </div>
        </script>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/mustache.js/3.0.1/mustache.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qs/6.6.0/qs.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script src="/js/chat.js"></script>
</body>

</html>